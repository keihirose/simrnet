\name{genpar}
\alias{genpar}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{
Generate parameters for simulation
}
\description{
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
Generate parameters used in the simulation.  The gene regulatory networks are generated by the graphical lasso. The regularization parameter is selected so that the extended Bayesian information criterion (EBIC) is minimized. The \code{genpar} function outputs three covariance matrices: Sigma1, Sigma2 and Sigma3. Sigma1 is the sample covariance matrix. Sigma2 and Sigma3 correspond to the random network and the scale-free network, respectively.
}
\usage{
genpar (X, Y, rho, scale=TRUE, delta.EBIC=0.5, delta.scalefree = 1, maxit.weight=100, 
                maxit.glasso = 10, n.test = 10, nfolds.glmnet=10, msg = TRUE)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{X}{
Design matrix; each row is an observation vector.
}
  \item{Y}{
Response vector.
}
  \item{rho}{
Candidate vector of tuning parameters. 
}
  \item{scale}{
Logical flag of whether \code{X} is scaled or not.
}
  \item{delta.EBIC}{
Tuning parameter in \code{EBIC}; default is 0.5.
}
  \item{delta.scalefree}{
Tuning parameter used in the log penalty. It must be positive value. Default is 1.
}
  \item{maxit.weight}{
Maximum number of iterations for each candidate of \code{rho}.
}
  \item{maxit.glasso}{
Maximum number of iterations in \code{glasso} function.
}
  \item{n.test}{
The number of observations for test data, which are selected from observations of \code{X} to calculate res and \code{sd.error}.
}
  \item{nfolds.glmnet}{
The number of folds in \code{cv.glmnet} function used in order to calculate \code{res}.
}
  \item{msg}{
Logical flag for displaying the message of which \code{rho} is currently computed.
}
}
\value{
  \item{Sigma}{
List of three covariance matrices: Sigma1, Sigma2 and Sigma3. Sigma1 is the sample covariance matrix of \code{X}. Sigma2 and Sigma3 correspond to the random network and the scale-free network, respectively.
}
  \item{A}{
List of matrices, which are upper triangular matrices obtained by Cholesky decomposition of Sigma.
}
  \item{res}{
Result of \code{cv.glmnet} function to determine beta and \code{sd.error}.
}
  \item{beta}{
Coefficient vector determined by lasso with data \code{X} and \code{Y}.
}
  \item{sd.error}{
Standard deviation of the error term used when generating data randomly in \code{simrnet} function.
}
  \item{omega2}{
List of inverse matrices of Sigma2 obtained for each \code{rho}.
}
  \item{omega3}{
List of inverse matrices of Sigma3 obtained for each \code{rho}.
}
  \item{BIC}{
Vector of Bayesian information criterion (BIC) for each \code{rho}.
}
  \item{EBIC}{
Vector of extended Bayesian information criterion (BIC) for each \code{rho}.
}
  \item{rho}{
Candidate vector of tuning parameters.
}
  \item{p}{
Dimension of columns of \code{X}.
}
  \item{mu}{
Vector of column means of \code{X}.
}
}
\references{
Okinaga, Y., Kyogoku, D., Kondo, S., Nagano, J. A. and Hirose, K.  The Accuracy of Lasso Estimation of Scale-Free Network, \emph{manuscript.}
}
\author{
Kei Hirose and Yuichi Okinaga\cr
\email{mail@keihirose.com}
}
%\note{
%%  ~~further notes~~
%}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{\code{simrnet} object.}

\examples{
data(nagano2019)
attach(nagano2019)
rho <- seq(0.1, 0.9, by = 0.1)
pars <- genpar(X,Y,rho)
result <- simrnet(pars, times.sim=5)
plot(result)
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.

%data(nagano2019)
%attach(nagano2019)
%X <- scale(X)
%rho <- seq(0.1, 0.9, by = 0.1)

%pars <- genpar(X,Y,rho)
%
%plot.simrnet(result)